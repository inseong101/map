<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì†Œì•„ê³¼í•™ ëª©ì°¨</title>
  <style>
    :root { color-scheme: light; }
    body { font-family: system-ui, -apple-system, "Noto Sans KR", Segoe UI, Roboto, Arial, sans-serif; margin:0; background:#fafbfc; }
    .topbar { position: sticky; top:0; z-index:10; background:#fff; border-bottom:1px solid rgba(0,0,0,.08); padding:10px 16px; }
    .topbar a { text-decoration:none; color:#0a66c2; font-weight:700; }
    .wrap { max-width: 960px; margin: 32px auto; padding: 0 16px; }
    h1 { margin: 0 0 12px; font-size: 24px; }

    /* ì¥ ì¹´ë“œ */
    .chapter { background:#fff; border:1px solid rgba(0,0,0,.08); border-radius:12px; margin-bottom:12px; overflow:hidden; }
    .chapter__head { display:flex; align-items:center; justify-content:space-between; gap:10px; padding:12px 14px; cursor:pointer; }
    .chapter__title { font-weight:800; color:#111; }
    .chapter__desc { color:#666; font-size:12px; }
    .toggle-btn {
      width:28px; height:28px; border-radius:8px; border:1px solid rgba(0,0,0,.12);
      background:#f5f6f8; color:#111; font-weight:900; display:flex; align-items:center; justify-content:center;
    }
    .toggle-btn:hover { background:#eef2f8; }
    .chapter__body { display:none; border-top:1px solid rgba(0,0,0,.06); padding:8px 12px 12px; }

    /* ì ˆ/í•­ëª© ë Œë”ë§ */
    .section { margin:10px 0; }
    .section__title { font-weight:800; margin:8px 0 6px; }
    .items { margin:0; padding-left:18px; }
    .items li { margin:4px 0; }

    /* ë¡œë”©/ì˜¤ë¥˜ */
    .loading { color:#666; font-size:13px; padding:6px 2px; }
    .error { color:#b00020; font-size:13px; padding:6px 2px; white-space:pre-line; }
  </style>
</head>
<body>
  <div class="topbar"><a href="/">â† í¬í„¸ë¡œ ëŒì•„ê°€ê¸°</a></div>
  <div class="wrap">
    <h1>ì†Œì•„ê³¼í•™ ëª©ì°¨</h1>
    <div id="chapters"></div>
  </div>

  <script>
    // ğŸ“ ë§ˆí¬ë‹¤ìš´ íŒŒì¼ë“¤ì´ ìˆëŠ” í´ë”
    const BASE = './chapter/';

    // ğŸ”¤ ì‹¤ì œ íŒŒì¼ëª… ëª©ë¡ (í•„ìš”ì‹œ ì¶”ê°€/ìˆ˜ì •)
const CHAPTERS = [
      "1ì¥ ì„œë¡ .md",
      "2á„Œá…¡á†¼ á„‰á…©á„‹á…¡á„‹á…´ á„Œá…µá†«á„ƒá…¡á†«.md",
      "3á„Œá…¡á†¼ á„‰á…¥á†¼á„Œá…¡á†¼á„€á…ª á„‡á…¡á†¯á„ƒá…¡á†¯.md",
      "4á„Œá…¡á†¼ á„‹á…²á„Œá…¥á†«.md",
      "5á„Œá…¡á†¼ á„‰á…©á„‹á…¡á„‹á…´ á„‹á…§á†¼á„‹á…£á†¼.md",
      "6á„Œá…¡á†¼ á„‰á…©á„‹á…¡ á„‹á…£á†¼á„‰á…¢á†¼(å°å…’ é¤Šç”Ÿ).md",
      "7á„Œá…¡á†¼ á„‰á…©á„‹á…¡ á„á…µá„…á…­á„‡á…¥á†¸.md",
      "8á„Œá…¡á†¼ á„‰á…µá†«á„‰á…¢á†¼á„‹á…¡ á„†á…µá†¾ á„á…©á„‰á…¢á†¼á„‡á…§á†¼.md",
      "9á„Œá…¡á†¼ á„€á…¡á†·á„‹á…§á†·á„‡á…§á†¼.md",
      "10á„Œá…¡á†¼ á„’á…©á„’á…³á†¸á„€á…µá„€á…¨á„‹á…´ á„‡á…§á†¼á„Œá…³á†¼ á„†á…µá†¾ á„Œá…µá†¯á„’á…ªá†«.md",
      "11á„Œá…¡á†¼ á„‰á…©á„’á…ªá„€á…µá„€á…¨á„‹á…´ á„‡á…§á†¼á„Œá…³á†¼ á„†á…µá†¾ á„Œá…µá†¯á„’á…ªá†«.md",
      "12á„Œá…¡á†¼ á„‰á…µá†«á„€á…§á†¼á„€á…¨á„‹á…´ á„‡á…§á†¼á„Œá…³á†¼ á„†á…µá†¾ á„Œá…µá†¯á„’á…ªá†«.md",
      "13á„Œá…¡á†¼ á„‰á…©á„‹á…¡á„á…¥á†¼á„‰á…©á„‚á…§á†«á„€á…µ á„Œá…¥á†¼á„‰á…µá†«á„Œá…¡á†¼á„‹á…¢.md",
      "14ì¥ ì‹¬í˜ˆê´€ê³„.md",
      "15á„Œá…¡á†¼ á„€á…¡á†«á„ƒá…¡á†·á„€á…¨á„‹á…´ á„‡á…§á†¼á„Œá…³á†¼ á„†á…µá†¾ á„Œá…µá†¯á„’á…ªá†«.md",
      "16á„Œá…¡á†¼ á„‡á…µá„‚á…­á„‰á…¢á†¼á„‰á…µá†¨á„€á…µá„€á…¨á„‹á…´ á„‡á…§á†¼á„Œá…³á†¼ á„†á…µá†¾ á„Œá…µá†¯á„’á…ªá†«.md",
      "17á„Œá…¡á†¼ á„‹á…¡á†¯á„…á…¦á„…á…³á„€á…µ á„Œá…µá†¯á„’á…ªá†«.md",
      "18á„Œá…¡á†¼ á„†á…§á†«á„‹á…§á†¨á„Œá…µá†¯á„’á…ªá†«.md",
      "19á„Œá…¡á†¼ á„€á…³á†«Â·á„€á…©á†¯á„€á…§á†¨á„€á…¨ á„Œá…µá†¯á„’á…ªá†«.md",
      "20á„Œá…¡á†¼ á„‚á…¢á„‡á…®á†«á„‡á…µá„Œá…µá†¯á„’á…ªá†«.md",
      "21á„Œá…¡á†¼ á„Œá…©á†¼á„‹á…£á†¼.md",
      "22á„Œá…¡á†¼ á„‘á…µá„‡á…®á„Œá…µá†¯á„’á…ªá†«.md",
      "23á„Œá…¡á†¼ á„‹á…¡á†«á„Œá…µá†¯á„’á…ªá†«.md",
      "24á„Œá…¡á†¼ á„Œá…³á†¼á„’á…®.md",
      "25á„Œá…¡á†¼ á„€á…³á†¸á„Œá…³á†¼(á„‰á…©á†«á„‰á…¡á†¼).md",
      "26á„Œá…¡á†¼ á„‰á…©á„‹á…¡á„‹á…´á„…á…­á„‹á…²á†«á„…á…µ.md"
    ];

      // íŒŒì¼ëª… â†’ ë²„íŠ¼ ë¼ë²¨ ë³€í™˜: "6ì¥ ì œëª©.md" â†’ "ì œ6ì¥ ì œëª©"
  function makeButtonLabel(filename) {
    const base = decodeURIComponent(filename.replace(/\.md$/i, ''));
    // ì•ìª½ ìˆ«ì ì¶”ì¶œ (ì˜ˆ: "6ì¥", "14ì¥", "10 ì¥" ë“± í­ë„“ê²Œ í—ˆìš©)
    const m = base.match(/^(\d+)\s*ì¥?\s*(.*)$/u);
    if (m) {
      const num = m[1];
      const rest = m[2] || '';
      return `ì œ${num}ì¥ ${rest}`; // ë„ì–´ì“°ê¸° ì—†ì´ ì œ+ìˆ«ì+ì¥
    }
    return base;
  }

  // Markdownì„ ì•„ì£¼ ë‹¨ìˆœí•˜ê²Œ HTMLë¡œ í‘œì‹œ (ë„¤ê°€ ì¨ë†“ì€ ë²ˆí˜¸/ë¬¸êµ¬ ê·¸ëŒ€ë¡œ ìœ ì§€)
  // - "# 1ì ˆ ..." â†’ "ì œ1ì ˆ ..." ë¡œë§Œ ë°”ê¿”ì„œ <h3>ë¡œ í‘œì‹œ
  // - "- " ë¡œ ì‹œì‘í•˜ëŠ” ì¤„ì€ <ul><li>ë¡œ ë¬¶ì–´ì¤Œ (ë²ˆí˜¸ëŠ” ë„¤ê°€ ì ì€ í…ìŠ¤íŠ¸ ê·¸ëŒ€ë¡œ ë³´ì¡´)
  function renderMarkdown(mdText) {
    // ì ˆ ì œëª©ì„ "ì œ1ì ˆ"ì²˜ëŸ¼ ë³´ì´ê²Œ (ë„ì–´ì“°ê¸° ì—†ìŒ)
    mdText = mdText.replace(/^#\s*(\d+)\s*ì ˆ\b/ugm, '# ì œ$1ì ˆ');

    const lines = mdText.split(/\r?\n/);
    let html = '';
    let inList = false;

    const flushList = () => {
      if (inList) { html += '</ul>'; inList = false; }
    };

    for (const raw of lines) {
      const line = raw.trim();

      if (!line) { flushList(); continue; }

      // ì ˆ ì œëª© (# ...)
      if (line.startsWith('# ')) {
        flushList();
        const text = line.replace(/^#\s+/, '');
        html += `<h3>${escapeHtml(text)}</h3>`;
        continue;
      }

      // ì¼ë°˜ í•­ëª©: "- "ë¡œ ì‹œì‘í•˜ë©´ ê·¸ëŒ€ë¡œ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
      if (/^- /.test(line)) {
        if (!inList) { html += '<ul>'; inList = true; }
        const item = line.replace(/^- /, ''); // ì•ì˜ '-'ë§Œ ì œê±°, ë„¤ê°€ ì ì€ "1. ..."ì€ ê·¸ëŒ€ë¡œ ë‚¨ê¹€
        html += `<li>${escapeHtml(item)}</li>`;
        continue;
      }

      // ê·¸ ì™¸ ì¤„: ë‹¨ë½ìœ¼ë¡œ í‘œì‹œ
      flushList();
      html += `<p>${escapeHtml(line)}</p>`;
    }
    flushList();
    return html;
  }

  function escapeHtml(s) {
    return s.replace(/[&<>"]/g, c => ({
      '&': '&nbsp;&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;'
    }[c]));
  }

  // ë²„íŠ¼ ëª©ë¡ ìƒì„± + í¼ì¹¨/ì ‘í˜
  const $list = document.getElementById('list');
  CHAPTERS.forEach(name => {
    const li = document.createElement('li');

    const btn = document.createElement('a');
    btn.href = 'javascript:void(0)';
    btn.textContent = makeButtonLabel(name);

    // í¼ì¹¨ ì˜ì—­
    const panel = document.createElement('div');
    panel.style.display = 'none';
    panel.style.margin = '6px 0 12px';
    panel.style.padding = '10px 12px';
    panel.style.border = '1px solid rgba(0,0,0,.12)';
    panel.style.borderRadius = '10px';
    panel.style.background = '#fff';

    // + í† ê¸€ ë²„íŠ¼
    const toggle = document.createElement('button');
    toggle.textContent = '+';
    toggle.style.marginLeft = '8px';
    toggle.style.fontWeight = '800';
    toggle.style.cursor = 'pointer';

    // ìƒë‹¨ ì¤„: ë³¸ë¬¸ ë²„íŠ¼ + í† ê¸€
    const header = document.createElement('div');
    header.appendChild(btn);
    header.appendChild(toggle);

    li.appendChild(header);
    li.appendChild(panel);
    $list.appendChild(li);

    // í† ê¸€ í´ë¦­ ì‹œ md ë¡œë“œ/í‘œì‹œ
    let loaded = false;
    toggle.addEventListener('click', async () => {
      if (panel.style.display === 'none') {
        // í¼ì¹¨
        panel.style.display = 'block';
        toggle.textContent = 'âˆ’';

        if (!loaded) {
          try {
            const url = BASE + encodeURIComponent(name);
            const res = await fetch(url, { cache: 'no-store' });
            if (!res.ok) throw new Error('fetch failed ' + res.status);
            const md = await res.text();
            panel.innerHTML = renderMarkdown(md);
            loaded = true;
          } catch (e) {
            panel.innerHTML = `<div style="color:#c00">ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: ${e.message}</div>`;
          }
        }
      } else {
        // ì ‘í˜
        panel.style.display = 'none';
        toggle.textContent = '+';
      }
    });
  });
</script>
